---
import { cn } from "../utils";

interface Option {
  value: string;
  label: string;
  disabled?: boolean;
}

interface Props {
  options?: Option[];
  placeholder?: string;
  size?: "sm" | "default";
  class?: string;
  wrapperClass?: string;
  value?: string;
  [key: string]: any;
}

const {
  options = [],
  placeholder,
  size = "default",
  class: className,
  wrapperClass,
  value,
  ...attrs
} = Astro.props as Props;

const sizeClass = size === "sm" ? "h-7 rounded-md text-xs" : "h-8 rounded-lg text-sm";
const hasSlotOptions = Astro.slots.has("default");
---

<div data-slot="select" class={cn("relative inline-flex w-full", wrapperClass)}>
  <select
    data-slot="select-trigger"
    class={cn(
      "border-border-input bg-background text-foreground w-full appearance-none border px-2.5 pr-8 outline-none transition-colors focus-visible:ring-2 focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50",
      sizeClass,
      className,
    )}
    value={value}
    {...attrs}
  >
    {placeholder != null && (
      <option value="" selected={value == null || value.length === 0}>
        {placeholder}
      </option>
    )}
    {options.map((option) => (
      <option value={option.value} disabled={option.disabled}>
        {option.label}
      </option>
    ))}
    {hasSlotOptions && <slot />}
  </select>
  <span
    aria-hidden="true"
    class="iconify ph--caret-down text-foreground-muted pointer-events-none absolute top-1/2 right-2 -translate-y-1/2 text-sm"
  />
</div>
