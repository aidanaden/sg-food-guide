---
import { cn } from "../../utils";

interface Props {
  content?: string;
  class?: string;
  contentClass?: string;
  side?: "top" | "right" | "bottom" | "left";
  [key: string]: any;
}

const {
  content,
  class: className,
  contentClass,
  side = "top",
  ...attrs
} = Astro.props as Props;

const sideClass = {
  top: "bottom-full left-1/2 mb-2 -translate-x-1/2",
  right: "left-full top-1/2 ml-2 -translate-y-1/2",
  bottom: "top-full left-1/2 mt-2 -translate-x-1/2",
  left: "right-full top-1/2 mr-2 -translate-y-1/2",
} as const;

const hasTooltip = (content != null && content.length > 0) || Astro.slots.has("content");
---

<span data-slot="tooltip" class={cn("group relative inline-flex", className)} {...attrs}>
  <span data-slot="tooltip-trigger" class="inline-flex">
    <slot />
  </span>

  {hasTooltip && (
    <span
      data-slot="tooltip-content"
      role="tooltip"
      class={cn(
        "bg-surface-overlay text-foreground ring-border pointer-events-none absolute z-50 rounded-md px-2 py-1 text-xs opacity-0 shadow-md ring-1 transition-opacity duration-150 group-hover:opacity-100 group-focus-within:opacity-100",
        sideClass[side],
        contentClass,
      )}
    >
      <slot name="content">{content}</slot>
    </span>
  )}
</span>
