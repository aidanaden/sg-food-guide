---
import { cn } from "../../utils";

interface Props {
  values?: number[];
  class?: string;
  heightRem?: number;
  stroke?: string;
  compact?: boolean;
  [key: string]: any;
}

const {
  values = [8, 14, 11, 18, 15, 20],
  class: className,
  heightRem = 10,
  stroke = "var(--color-primary)",
  compact = false,
  ...attrs
} = Astro.props as Props;

const max = Math.max(...values, 1);
const min = Math.min(...values, 0);
const range = Math.max(max - min, 1);
const points = values
  .map((value, index) => {
    const x = values.length === 1 ? 50 : (index / (values.length - 1)) * 100;
    const y = 100 - ((value - min) / range) * 100;
    return `${x},${y}`;
  })
  .join(" ");
---

<div class={cn("w-full", className)} {...attrs}>
  <svg
    data-slot="uplot-time-series"
    viewBox="0 0 100 100"
    class={cn("w-full", compact ? "h-16" : undefined)}
    style={compact ? undefined : `height: ${heightRem}rem;`}
    preserveAspectRatio="none"
  >
    <polyline points={points} fill="none" stroke={stroke} stroke-width="2" vector-effect="non-scaling-stroke" />
  </svg>
</div>
