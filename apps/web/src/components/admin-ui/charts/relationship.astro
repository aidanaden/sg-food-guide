---
import { cn } from "../utils";

interface Point {
  x: number;
  y: number;
  label?: string;
}

interface Props {
  points?: Point[];
  class?: string;
  [key: string]: any;
}

const {
  points = [
    { x: 12, y: 42, label: "A" },
    { x: 24, y: 55, label: "B" },
    { x: 36, y: 30, label: "C" },
    { x: 48, y: 66, label: "D" },
    { x: 62, y: 38, label: "E" },
    { x: 80, y: 58, label: "F" },
  ],
  class: className,
  ...attrs
} = Astro.props as Props;

const minX = Math.min(...points.map((point) => point.x), 0);
const maxX = Math.max(...points.map((point) => point.x), 1);
const minY = Math.min(...points.map((point) => point.y), 0);
const maxY = Math.max(...points.map((point) => point.y), 1);

const rangeX = Math.max(maxX - minX, 1);
const rangeY = Math.max(maxY - minY, 1);
---

<div data-slot="relationship-chart" class={cn("w-full", className)} {...attrs}>
  <svg viewBox="0 0 100 60" class="border-border bg-muted/20 h-44 w-full rounded-lg border" preserveAspectRatio="none">
    {points.map((point) => {
      const x = ((point.x - minX) / rangeX) * 100;
      const y = 60 - ((point.y - minY) / rangeY) * 60;
      return (
        <g>
          <circle cx={x} cy={y} r="1.8" fill="var(--color-primary)" fill-opacity="0.8" />
          {point.label != null && <title>{point.label}</title>}
        </g>
      );
    })}
  </svg>
</div>
